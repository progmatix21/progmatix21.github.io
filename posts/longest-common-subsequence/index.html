<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Longest Common Subsequence - Progmatix 21</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="Progmatix 21" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">Progmatix 21</div>
					<div class="logo__tagline">My learnings: byte by byte</div>
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Longest Common Subsequence</h1>
			<p class="post__lead">...with an unconventional approach</p>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" class="meta__icon icon icon-calendar" width="18" height="16" 
	 viewBox="0 0 458 458" style="enable-background:new 0 0 458 458;" xml:space="preserve">
<g>
	<path d="M111.938,135.598c11.046,0,20-8.954,20-20V21.597c0-11.046-8.954-20-20-20s-20,8.954-20,20v94.001
		C91.938,126.644,100.892,135.598,111.938,135.598z"/>
	<path d="M346.063,135.598c11.046,0,20-8.954,20-20V21.597c0-11.046-8.954-20-20-20s-20,8.954-20,20v94.001
		C326.063,126.644,335.017,135.598,346.063,135.598z"/>
	<path d="M443,82.403h-46.938c0,12.42,0,20.918,0,33.195c0,27.614-22.386,50-50,50c-27.614,0-50-22.386-50-50
		c0-12.281,0-20.771,0-33.195H161.938c0,12.42,0,20.918,0,33.195c0,27.614-22.386,50-50,50c-27.614,0-50-22.386-50-50
		c0-12.281,0-20.771,0-33.195H15c-8.284,0-15,6.716-15,15v89.641h458V97.403C458,89.119,451.284,82.403,443,82.403z"/>
	<path d="M0,441.403c0,8.284,6.716,15,15,15h428c8.284,0,15-6.716,15-15V227.044H0V441.403z M244.191,313.046
		c0-6.036,3.59-11.504,9.127-13.907c7.49-3.249,16.316-9.028,21.176-13.393c2.782-2.499,6.38-3.88,10.121-3.88h19.254
		c4.395,0,7.957,3.563,7.957,7.958v80.903h11.445c8.275,0,14.984,6.708,14.984,14.984c0,8.275-6.708,14.984-14.984,14.984h-59.934
		c-8.275,0-14.984-6.708-14.984-14.984c0-8.275,6.708-14.984,14.984-14.984h14.567V317.66c-2.163,2.886-6.797,6.077-12.243,8.754
		c-4.618,2.27-10.076,2.008-14.445-0.711c-4.369-2.718-7.025-7.501-7.025-12.647V313.046z M123.295,390.677
		c2.691-29.175,18.127-37.168,47.125-52.83c4.622-2.493,12.811-7.06,15.92-11.134c3.842-5.044,1.97-18.001-14.359-18.001
		c-5.549,0-11.094,1.106-17.704,5.967c-6.262,4.605-14.984,3.637-20.067-2.244l-0.594-0.688c-3.026-3.501-4.246-8.216-3.31-12.747
		s3.925-8.371,8.09-10.387c22.329-10.811,56.654-13.101,73.853,0.952c7.977,6.523,11.966,15.332,11.966,26.43
		c0,32.434-40.129,38.997-54.315,54.731h41.622c8.275,0,14.984,6.708,14.984,14.984c0,8.275-6.708,14.984-14.984,14.984h-79.1
		c-2.577,0-5.036-1.095-6.772-3C123.914,395.789,123.059,393.243,123.295,390.677z"/>
</g>
</svg>
<time class="meta__text" datetime="2023-11-21T19:39:01&#43;05:30">November 21, 2023</time></div>
<div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/algorithms/" rel="category">algorithms</a>
	</span>
</div><div class="meta__item-categories meta__item">
	<span class="meta__text">
		<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>1062 words/5 min read
	</span>
</div>
</div>
		</header>
		
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
	    <details>
	        <summary>Click to toggle</summary>
		        <nav id="TableOfContents">
  <ul>
    <li><a href="#the-implementation">The Implementation</a>
      <ul>
        <li><a href="#populating-the-solution-space">Populating the solution space</a></li>
        <li><a href="#identifying-the-solution">Identifying the solution</a></li>
      </ul>
    </li>
    <li><a href="#takeaways">Takeaways</a></li>
  </ul>
</nav>
		    </details>
	</div>
</div>
<div class="content post__content clearfix">
			
<style>
#myBtn {
  display: none;
  position: fixed;
  bottom: 20px;
  right: 30px;
  z-index: 99;
  font-size: 36px;
  font-weight: bold;
  border: none;
  outline: none;
  background-color: #444;
  color: white;
  cursor: pointer;
  padding: 15px;
  border-radius: 50%;
}

#myBtn:hover {
  background-color: #008080;
}
</style>

<button onclick="topFunction()" id="myBtn" title="Go to top">&#9650;</button>


<script>

let mybutton = document.getElementById("myBtn");


window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}


function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>



<p>The longest common subsequence (LCS) problem is typically solved using the classic
dynamic programming approach: bottom-up with memo.  Here, we attempt an atypical
implementation which solves the LCS problem across three sequences using a sparse
memo.</p>
<p>Problems amenable to dynamic programming have to meet two important criteria:</p>
<ul>
<li>
<p>Optimal substructure: Solving a subproblem optimally, contributes to the optimal
solution of the larger problem.  The longest subsequence terminating at a particular
point in the string, is made up of &lsquo;smaller&rsquo; longest subsequences
terminating at successively preceding points.</p>
</li>
<li>
<p>Overlapping subproblems: The longest subsequence is made up of constituent
subsequences which are the longest at their respective points of termination.
As the subsequence grows, we recursively or iteratively search for the longest
preceding subsequence and end up solving the same subproblems over and over.</p>
</li>
</ul>
<h2 id="the-implementation">The Implementation</h2>
<p>We share the implementation in four parts.  The first part below is the function
definition of LCS and reading in the arguments.</p>
<div class="highlight"><div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic">#! /usr/bin/env python3</span>

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">random</span>

<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">longest_subsequence</span>(s1, s2, s3):
    <span style="color:#ba2121">&#39;&#39;&#39;Input: three sequences.  Repeat one sequence if you have only two.
</span><span style="color:#ba2121">       Output: tuple with length of LCS, matching subsequence indices in
</span><span style="color:#ba2121">               sequence 1,2 and 3 respectively.
</span><span style="color:#ba2121">    &#39;&#39;&#39;</span>

    ls1 <span style="color:#666">=</span> [None] <span style="color:#666">+</span> <span style="color:#008000">list</span>(s1)<span style="color:#666">.</span>copy()   <span style="color:#408080;font-style:italic"># padding to help with edge conditions</span>
    ls2 <span style="color:#666">=</span> [None] <span style="color:#666">+</span> <span style="color:#008000">list</span>(s2)<span style="color:#666">.</span>copy()
    ls3 <span style="color:#666">=</span> [None] <span style="color:#666">+</span> <span style="color:#008000">list</span>(s3)<span style="color:#666">.</span>copy()
        
    m, n, r <span style="color:#666">=</span> <span style="color:#008000">len</span>(ls1), <span style="color:#008000">len</span>(ls2), <span style="color:#008000">len</span>(ls3)</code></pre></td></tr></table>
</div>
</div>
<h3 id="populating-the-solution-space">Populating the solution space</h3>
<p>The second part below implements the sparse data structure (<code>memo</code>), the solution
search (<code>max3d</code>) and the nested loop that implements the recurrence relation for LCS.</p>
<p>Our <code>memo</code> is sparse in the sense we keep track of only the intersections and the
length of the longest subsequence terminating at that point as a 4-tuple.  Each
4-tuple: <code>(l,i,j,k)</code> represents the longest subsequence terminating at the
intersection <code>(i,j,k)</code> with its length <code>l</code>.  These are the solutions to our subproblems.</p>
<p>A subsequence has to necessarily end at the matching intersection of strings
(3 in our case).  Thus, finding the longest subsequence at an intersection <code>(i,j,k)</code>
involves finding the longest subsequence among all preceding/prior intersections
and adding 1 to it.</p>
<blockquote>
<p><strong>Intuition:</strong> Finding this longest preceding subsequence involves locating
the 4-tuple in the cuboid space (because we have 3 strings) enclosed by the planes
<code>x=0,y=0,z=0</code> and <code>x=i,y=j,z=k</code>, that corresponds to the longest preceding subsequence.
This is an implementation of our recurrence relation.</p>
</blockquote>
<p>Note that <code>x,y,z</code> axes represent the 1-based indices of the three respective strings
layed out along these axes.  It is also important to have a base-case tuple <code>(0,0,0,0)</code>
to initialize our sparse memo.</p>
<div class="highlight"><div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    memo <span style="color:#666">=</span> [(<span style="color:#666">0</span>,<span style="color:#666">0</span>,<span style="color:#666">0</span>,<span style="color:#666">0</span>)] <span style="color:#408080;font-style:italic"># sparse--will have info only on non-zero matches.    </span>
    <span style="color:#408080;font-style:italic"># Searches for and returns the longest substring in the space preceding a triple intersection.</span>
    max3d <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">lambda</span> i,j,k: <span style="color:#008000">max</span>([tup <span style="color:#008000;font-weight:bold">for</span> tup <span style="color:#a2f;font-weight:bold">in</span> memo <span style="color:#008000;font-weight:bold">if</span> (
                          tup[<span style="color:#666">1</span>] <span style="color:#666">&lt;</span> i  <span style="color:#a2f;font-weight:bold">and</span> tup[<span style="color:#666">2</span>] <span style="color:#666">&lt;</span> j <span style="color:#a2f;font-weight:bold">and</span> tup[<span style="color:#666">3</span>] <span style="color:#666">&lt;</span> k)],
                          default<span style="color:#666">=</span>(<span style="color:#666">0</span>,<span style="color:#666">0</span>,<span style="color:#666">0</span>,<span style="color:#666">0</span>))   

    <span style="color:#008000;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">1</span>,m):
        <span style="color:#008000;font-weight:bold">for</span> j <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">1</span>,n):
            <span style="color:#008000;font-weight:bold">for</span> k <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">1</span>,r):
                <span style="color:#008000;font-weight:bold">if</span> (ls1[i] <span style="color:#666">==</span> ls2[j]) <span style="color:#a2f;font-weight:bold">and</span> (ls2[j] <span style="color:#666">==</span> ls3[k]):  <span style="color:#408080;font-style:italic"># match at i,j,k</span>
                    memo<span style="color:#666">.</span>append((max3d(i,j,k)[<span style="color:#666">0</span>]<span style="color:#666">+</span><span style="color:#666">1</span>, i, j, k))</code></pre></td></tr></table>
</div>
</div>
<h3 id="identifying-the-solution">Identifying the solution</h3>
<p>We have the memo filled up now, with tuples that have all longest subsequence
terminations at each intersection <code>(i,j,k)</code>.  All we have to do is find the
tuple with the maximum LCS length.  However, we do more: we identify the indices
of the LCS in each of the three strings and thus the literal LCS as well.</p>
<p>The <code>while</code> loop starts with the maximum value of the LCS and works its way back
to the previous termination iteratively until it reaches the first element in the
sequence using the same solution search approach (<code>max3d</code>).</p>
<div class="highlight"><div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    res <span style="color:#666">=</span> []   <span style="color:#408080;font-style:italic"># Structure to return result</span>
    p,q,v <span style="color:#666">=</span> m,n,r
    
    last_term <span style="color:#666">=</span> <span style="color:#008000">max</span>(memo) <span style="color:#408080;font-style:italic"># tuple with longest subseq length and coordinates</span>
    res<span style="color:#666">.</span>append(last_term) <span style="color:#408080;font-style:italic"># append to result data</span>

    p,q,v <span style="color:#666">=</span> last_term[<span style="color:#666">1</span>], last_term[<span style="color:#666">2</span>], last_term[<span style="color:#666">3</span>]

    <span style="color:#008000;font-weight:bold">while</span> (maxtup :<span style="color:#666">=</span> max3d(p,q,v))[<span style="color:#666">0</span>] <span style="color:#666">&gt;</span> <span style="color:#666">0</span>:
        res<span style="color:#666">.</span>append(maxtup)
        p,q,v <span style="color:#666">=</span> maxtup[<span style="color:#666">1</span>],maxtup[<span style="color:#666">2</span>],maxtup[<span style="color:#666">3</span>]
        
    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#008000">len</span>(res) <span style="color:#666">==</span> <span style="color:#666">1</span>:  <span style="color:#408080;font-style:italic"># No common sequence found</span>
        <span style="color:#008000;font-weight:bold">return</span> (<span style="color:#666">0</span>,[],[],[])
        
    res <span style="color:#666">=</span> res[::<span style="color:#666">-</span><span style="color:#666">1</span>]   <span style="color:#408080;font-style:italic"># Reverse to get ascending order</span>
    <span style="color:#408080;font-style:italic"># array of subseq indices in s1,s2,s3</span>
    _, is1, is2, is3 <span style="color:#666">=</span> <span style="color:#008000">list</span>(<span style="color:#008000">zip</span>(<span style="color:#666">*</span>res)) 
    
    <span style="color:#408080;font-style:italic"># Convert these to 0 based indices</span>
    is1 <span style="color:#666">=</span> [e<span style="color:#666">-</span><span style="color:#666">1</span> <span style="color:#008000;font-weight:bold">for</span> e <span style="color:#a2f;font-weight:bold">in</span> is1]
    is2 <span style="color:#666">=</span> [e<span style="color:#666">-</span><span style="color:#666">1</span> <span style="color:#008000;font-weight:bold">for</span> e <span style="color:#a2f;font-weight:bold">in</span> is2]
    is3 <span style="color:#666">=</span> [e<span style="color:#666">-</span><span style="color:#666">1</span> <span style="color:#008000;font-weight:bold">for</span> e <span style="color:#a2f;font-weight:bold">in</span> is3]
        
    <span style="color:#008000;font-weight:bold">return</span>(<span style="color:#008000">len</span>(is1), is1, is2, is3)</code></pre></td></tr></table>
</div>
</div>
<p>To exercise our code, we create three random substrings and get the LCS common
to them.</p>
<div class="highlight"><div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">                        
<span style="color:#008000;font-weight:bold">if</span> __name__ <span style="color:#666">==</span> <span style="color:#ba2121">&#34;__main__&#34;</span>:
    <span style="color:#408080;font-style:italic"># Generate three random alphanumeric sequences</span>
    <span style="color:#408080;font-style:italic"># numerals, upper and lower case    </span>
    chars <span style="color:#666">=</span> [<span style="color:#008000">chr</span>(c<span style="color:#666">+</span><span style="color:#666">48</span>) <span style="color:#008000;font-weight:bold">for</span> c <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">10</span>)] <span style="color:#666">+</span> \
            [<span style="color:#008000">chr</span>(c<span style="color:#666">+</span><span style="color:#666">65</span>) <span style="color:#008000;font-weight:bold">for</span> c <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">26</span>)] <span style="color:#666">+</span> \
            [<span style="color:#008000">chr</span>(c<span style="color:#666">+</span><span style="color:#666">97</span>) <span style="color:#008000;font-weight:bold">for</span> c <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(<span style="color:#666">26</span>)]

    rnd_str <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">lambda</span> length: [random<span style="color:#666">.</span>choice(chars) <span style="color:#008000;font-weight:bold">for</span> _ <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(length)]
    s1,s2,s3 <span style="color:#666">=</span> rnd_str(<span style="color:#666">70</span>), rnd_str(<span style="color:#666">75</span>), rnd_str(<span style="color:#666">80</span>)

    <span style="color:#408080;font-style:italic"># Test case for non-overlapping strings</span>
    <span style="color:#408080;font-style:italic"># s1,s2,s3 = &#34;abcdefg&#34;,&#34;hijklmn&#34;,&#34;opqrstu&#34;</span>
    
    <span style="color:#008000;font-weight:bold">print</span>(<span style="color:#ba2121">&#34;The three strings:&#34;</span>)
    <span style="color:#008000;font-weight:bold">print</span>(<span style="color:#ba2121">&#39;&#39;</span><span style="color:#666">.</span>join(s1),<span style="color:#ba2121">&#39;&#39;</span><span style="color:#666">.</span>join(s2),<span style="color:#ba2121">&#39;&#39;</span><span style="color:#666">.</span>join(s3), sep<span style="color:#666">=</span><span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span> )
    
    <span style="color:#008000;font-weight:bold">print</span>(<span style="color:#ba2121">&#34;</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">Length of longest subsequence, its indices in s1,s2,s3&#34;</span>)
    <span style="color:#008000;font-weight:bold">print</span>(result :<span style="color:#666">=</span> longest_subsequence(s1,s2,s3))
    <span style="color:#408080;font-style:italic"># To get the literal subsequence, filter (say) s1 using its lcs indices</span>
    <span style="color:#008000;font-weight:bold">print</span>(<span style="color:#ba2121">&#34;Longest subsequence in s1,s2,s3: &#34;</span>,[s1[i] <span style="color:#008000;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> result[<span style="color:#666">1</span>]])    </code></pre></td></tr></table>
</div>
</div>
<p>The output of the program is:</p>
<pre><code>The three strings:
aYM7zR76GWMyWmdwpb98syIZ3UgDP9OUKdgQuqM4JqGNpAdnpe9qtvZX3gidinQqxqa7vC
cVTJwuwMXl4sO1AopWUdjlyhrsdztMRhsSnjmEe5bFce9VjxIqLg2zagKNcnkcZHlqdsFPMM8aT
r4WTlMZnA2MRIydpRgfh5oxnBWrHxhsi20IPhAzXDjBN9k41rPNGXHum2AvRvUtZgVOT8LjUYZLmVAci

Length of longest subsequence, its indices in s1,s2,s3
(7, [10, 11, 14, 20, 29, 43, 54], [7, 22, 26, 32, 44, 57, 62], [10, 13, 14, 30, 44, 50, 73])
Longest subsequence in s1,s2,s3:  ['M', 'y', 'd', 's', '9', 'N', 'Z']

</code></pre><h2 id="takeaways">Takeaways</h2>
<p>We have here, an implementation of LCS that is frugal on memory and extensible
across two or more strings.  The bottleneck is the nested loop that checks for
intersection across the lists.  We have also illustrated an intuitive
conceptualization of the LCS problem and the exploration of its solution space.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/lcs/" rel="tag">lcs</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/roc-curve-step-by-step/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Roc Curve Step by Step</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/calibrate-your-classifier/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Calibrate Your Classifier</p>
		</a>
	</div>
</nav>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
<div class="footer__links">
	<a class="footer__link" href="/about/">About</a>
</div>
		<div class="footer__copyright">
			&copy; 2025 Atrij Talgery.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>